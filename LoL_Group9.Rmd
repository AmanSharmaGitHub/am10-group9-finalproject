---
title: "LoL_Group9"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

(1) A statement of the question or purpose. What problems or questions did you set out to analyse?
What were the key issues raised?

League of Legends is a Multiplayer Online Battle Arena (MOBA) game. For this project we have data on the first 10 minutes of 10,000 games.
All of these games are diamond-ranked, which means the players are in the top 1.5% to 0.19% of players worldwide.

(2) The background and preparation for conducting the project. How did you prepare for the project?
What sources or background readings did you consult? What information did you use in developing
your ideas from the conceptual stage to the finished project?
(3) Methodology. What did you do, and how did you do it? What statistical techniques did you use â€”
for instance, scatterplots, correlation, confidence intervals, linear/logistic regression?
(4) Results and conclusions. This is where you summarise and present your data analyses and
communicate your main results. What did you find out? This might include tables, graphs, or verbal
summaries. What did you learn about the problem or question you set out to investigate?
(5) Discussion and critique. What did you learn about the process of carrying out your project? What
went wrong, and how could you improve it next time? For instance, did any sources of bias creep into
your survey or experiment? What advice would you give future students? 

```{r libraries, include=FALSE}
library(tidyverse)
library(extrafont)
library(vroom)
library(skimr)
library(sf) 

loadfonts(device="pdf") 
```

## Loading the Dataset 
```{r}
#Loading the dataset
raw_lol_data <- read.csv("high_diamond_ranked_10min.csv")

#Initial cleaning of names and dropping any na's 
raw_lol_data <- raw_lol_data %>% 
  janitor::clean_names() %>% 
  drop_na()
```

# Cleaning the Data 
```{r Vera}

# Checking that variables are all stored as the right type 
glimpse(raw_lol_data)

#Skimming Data to check that there are no missing values
skimr::skim(raw_lol_data)

#Checking for duplicates in the dataset
dupes <- raw_lol_data %>% 
  janitor::get_dupes()

#Cleaning the data
clean_lol_data <- raw_lol_data %>% 
  #we saw that there were duplicate columns between the blue and the red variables, so we decided to drop the red and keep the blue
  select(-red_first_blood, -red_gold_diff) %>% 
  # We added a column that shows the average level difference between the blue and the red teams
  mutate(avg_level_diff = blue_avg_level - red_avg_level)

clean_lol_data


```

```{r Aman}
# Correlations

Corr_clean_lol_data <- clean_lol_data %>%
  select(blue_wins, blue_first_blood, blue_kills, blue_deaths, avg_level_diff, blue_experience_diff)
Corr <- Corr_clean_lol_data %>% 
  GGally::ggpairs()
Corr

```

```{r Regression}
# Regression

# Starting with a simple linear regression
regression_clean_lol_data1 <- lm(blue_wins ~ blue_first_blood, data=clean_lol_data, family = "binomial")
summary(regression_clean_lol_data1)

# Multiple linear regression

regression_clean_lol_data2 <- lm(blue_wins ~ blue_first_blood + blue_kills + avg_level_diff + blue_experience_diff, data=clean_lol_data, family = "binomial")
summary(regression_clean_lol_data2)

# Logistic Regression
regression_clean_lol_data3 <- glm(blue_wins ~ blue_first_blood + blue_kills + avg_level_diff + blue_experience_diff, data=clean_lol_data, family = "binomial")
summary(regression_clean_lol_data3)

# Investigating collinearity
exp_level_differential <- lm(avg_level_diff ~ blue_experience_diff, data =clean_lol_data)
summary(exp_level_differential)

# Logistic Regression
regression_clean_lol_data4 <- glm(blue_wins ~ blue_first_blood + blue_kills + blue_experience_diff, data=clean_lol_data, family = "binomial")
summary(regression_clean_lol_data4)

# Does teamwork payoff?
regression_clean_lol_data5 <- glm(blue_wins ~ blue_kills*blue_assists, data=clean_lol_data, family = "binomial")
summary(regression_clean_lol_data5)

reg_expdiff <- glm(blue_wins ~ avg_level_diff, data = clean_lol_data, family = "binomial")

plot_log <- broom::augment(reg_expdiff, type.predict = "response")
head(plot_log)

plot1 <- ggplot(plot_log, aes(x=avg_level_diff)) +
  geom_line(aes(y= .fitted), color = "blue") +
  labs(x="Experience Differential", y = "Blue Wins") +
  geom_point(aes(y=blue_wins), alpha = 0.2) +
  NULL
plot1


```
